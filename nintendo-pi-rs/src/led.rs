//! LED patterns for the physical controller.
//!
//! Uses nusb for USB bulk writes. Each pattern is a 16-byte command.

use crate::usb::init::send_led_command;

/// Player 1 pattern (normal): LED 1 on.
pub const LED_NORMAL: [u8; 16] = [
    0x09, 0x91, 0x00, 0x07, 0x00, 0x08, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
];

/// Macro mode pattern: LEDs 2+3 on.
pub const LED_MACRO_MODE: [u8; 16] = [
    0x09, 0x91, 0x00, 0x07, 0x00, 0x08, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
];

/// Recording pattern: all LEDs blinking.
pub const LED_RECORDING: [u8; 16] = [
    0x09, 0x91, 0x00, 0x07, 0x00, 0x08, 0x00, 0x00, 0x0F, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
];

/// Playback pattern: LEDs 1+3 on.
pub const LED_PLAYBACK: [u8; 16] = [
    0x09, 0x91, 0x00, 0x07, 0x00, 0x08, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
];

/// Send an LED pattern to the physical controller (best-effort, non-blocking).
pub fn set_led(pattern: &[u8; 16]) {
    // Spawn in a thread since send_led_command does USB I/O
    let pattern = *pattern;
    std::thread::spawn(move || {
        send_led_command(&pattern);
    });
}
